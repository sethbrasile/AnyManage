---
phase: 03-entity-management
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/protocols/entity-onboarding.md
  - INSTRUCTIONS.md
autonomous: true

must_haves:
  truths:
    - "User can say 'Add new client Acme Corp' and folder structure is created"
    - "Entity names are normalized to title case automatically"
    - "User sees confirmation with suggested next steps"
    - "Duplicate entity names are detected and handled gracefully"
  artifacts:
    - path: "docs/protocols/entity-onboarding.md"
      provides: "Complete onboarding protocol documentation"
      contains: "## Onboarding Flow"
    - path: "INSTRUCTIONS.md"
      provides: "Core Workflows section with onboarding reference"
      contains: "Entity Onboarding"
  key_links:
    - from: "INSTRUCTIONS.md"
      to: "docs/protocols/entity-onboarding.md"
      via: "reference in Core Workflows section"
      pattern: "docs/protocols/entity-onboarding"
---

<objective>
Create the entity onboarding protocol documentation that enables users to create new entities with natural language commands.

Purpose: This is the foundational workflow for Phase 3 - without onboarding, users cannot create entities to manage. Other workflows (profile building, note processing) depend on entities existing.

Output: Protocol documentation in docs/protocols/ and updated INSTRUCTIONS.md with onboarding workflow reference.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-entity-management/03-CONTEXT.md

# Existing files to reference
@INSTRUCTIONS.md
@docs/protocols/session-protocol.md
@templates/ENTITY_PROFILE_TEMPLATE.md
@templates/ENTITY_ROADMAP_TEMPLATE.md
@CONFIG.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create entity onboarding protocol documentation</name>
  <files>docs/protocols/entity-onboarding.md</files>
  <action>
Create comprehensive protocol documentation for entity onboarding. The document must cover:

**Trigger Detection:**
- Natural language patterns: "Add new client X", "Create entity X", "New client X"
- Slash command: `/new [name]`
- Extract entity name from user input

**Name Normalization:**
- Convert to title case ("ACME CORP" -> "Acme Corp", "acme corp" -> "Acme Corp")
- Handle special cases (acronyms, apostrophes, hyphens)
- Folder name = normalized entity name

**Duplicate Detection:**
- Before creating, check entities/ folder for similar names
- Exact match: "Entity 'Acme Corp' already exists. Did you mean to update it?"
- Similar match (>80% fuzzy): "Found similar entity 'Acme Corporation'. Create anyway or use existing?"
- Let user choose: create with different name, use existing, or proceed anyway

**Folder Creation:**
- Create entities/[Name]/ directory
- Create standard subfolders: notes/, notes/archive/
- Copy templates: ENTITY_PROFILE_TEMPLATE.md -> ENTITY_PROFILE.md (replace [Entity Name] placeholder)
- Copy templates: ENTITY_ROADMAP_TEMPLATE.md -> ENTITY_ROADMAP.md (replace [Entity Name] placeholder)
- Add timestamps to created files

**Master Roadmap Update:**
- Add new entity to ROADMAP.md in appropriate priority section (default: Medium)
- Use checkbox format: `- [ ] Entity Name - [status description]`

**Confirmation:**
- Confirm creation: "Created Acme Corp with profile and roadmap."
- Suggest next steps: "Add some details? Process notes? Show available commands?"
- DO NOT ask questions before creating - create first, enhance after

**Error Handling:**
- Folder creation fails: "Couldn't create entity folder. Try again?"
- Template not found: Use minimal fallback templates inline

Format: Follow existing protocol doc style (see session-protocol.md).
Include examples of user commands and expected agent responses.
  </action>
  <verify>
File exists at docs/protocols/entity-onboarding.md with:
- Trigger patterns section
- Name normalization rules
- Duplicate detection logic
- Folder structure specification
- Confirmation message templates
- At least 3 example interactions
  </verify>
  <done>
Protocol document covers all aspects of entity onboarding from CONTEXT.md:
minimal creation, normalized naming, next step prompts, duplicate handling.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update INSTRUCTIONS.md with onboarding workflow</name>
  <files>INSTRUCTIONS.md</files>
  <action>
Update INSTRUCTIONS.md to reference the new entity onboarding protocol.

**In "Core Workflows" section, expand the Entity Onboarding entry:**

Current text:
```
- **Entity Onboarding:** Create folder in `entities/` from templates, add to ROADMAP.md
```

Replace with:
```
- **Entity Onboarding:** Create new entities with "Add new client [Name]" or `/new [Name]`. Creates folder structure with profile and roadmap from templates, adds to master ROADMAP.md. See `docs/protocols/entity-onboarding.md` for full protocol.
```

**In "Command Patterns" table, add row:**
```
| "Add new client Acme" | `/new Acme` | Create entity folder |
```

Ensure the row appears in logical order (creation before processing).

**Do NOT modify other sections.** Keep changes minimal and focused.
  </action>
  <verify>
INSTRUCTIONS.md contains:
- Expanded Entity Onboarding entry in Core Workflows
- Reference to docs/protocols/entity-onboarding.md
- New row in Command Patterns table for entity creation
  </verify>
  <done>
INSTRUCTIONS.md provides clear entry point for onboarding workflow with pointer to detailed protocol.
  </done>
</task>

</tasks>

<verification>
After completing both tasks:
1. Verify docs/protocols/entity-onboarding.md exists and is >100 lines
2. Verify INSTRUCTIONS.md references the new protocol
3. Verify Command Patterns table has entity creation row
4. Read both files to confirm consistency
</verification>

<success_criteria>
- Entity onboarding protocol fully documented
- INSTRUCTIONS.md updated with workflow reference
- Documentation matches decisions from 03-CONTEXT.md (minimal creation, title case normalization, next step prompts, duplicate handling)
- No conflicting instructions between files
</success_criteria>

<output>
After completion, create `.planning/phases/03-entity-management/03-01-SUMMARY.md`
</output>
